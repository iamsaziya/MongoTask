<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard | MongoTask</title>
  <!-- Material Icons -->
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=search" />

  <!-- Custom CSS -->
  <link rel="stylesheet" href="css/style.css" />

  <style>
    .material-symbols-rounded {
      font-variation-settings: "FILL" 0, "wght" 400, "GRAD" 0, "opsz" 24;
    }

    body {
      overflow-x: hidden;
    }
  </style>
</head>

<body>
  <div id="sidebar"></div>
  <main>
    <div id="header" data-filter="true"></div>
    <div class="wrapper">
      @foreach project in projects
      <div class="task-card" onclick="window.location.href='/projects/{{project.projectId}}'">
        <div class="card-header">
          <div>
            <span class="priority-badge">{{project.status}}</span>
            <h3 class="task-title">{{project.name}}</h3>
            <p class="task-description">
              {{project.description}}
            </p>
          </div>
          <button class="menu-button">
            <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
              <circle cx="5" cy="12" r="2" />
              <circle cx="12" cy="12" r="2" />
              <circle cx="19" cy="12" r="2" />
            </svg>
          </button>
        </div>

        <div class="card-footer">
          <div class="avatar-group">
            <img src="https://via.placeholder.com/32" class="avatar" alt="User 1" />
            <img src="https://via.placeholder.com/32" class="avatar" alt="User 2" />
          </div>

          <div class="stats">
            <div class="stat">
              <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2" stroke-width="2" />
                <circle cx="9" cy="7" r="4" stroke-width="2" />
                <path d="M23 21v-2a4 4 0 00-3-3.87" stroke-width="2" />
                <path d="M16 3.13a4 4 0 010 7.75" stroke-width="2" />
              </svg>
              <span>{{project.assignees.length}}</span>
            </div>
            <div class="stat">
              <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M8 12h8M8 16h4" stroke-width="2" stroke-linecap="round" />
                <path d="M16 4H8a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V6a2 2 0 00-2-2z" stroke-width="2" />
              </svg>
              <span>16</span>
            </div>
          </div>
        </div>
      </div>
      @end
    </div>
  </main>
  <button class="float-btn">
    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor">
      <path
        d="M440-440H240q-17 0-28.5-11.5T200-480q0-17 11.5-28.5T240-520h200v-200q0-17 11.5-28.5T480-760q17 0 28.5 11.5T520-720v200h200q17 0 28.5 11.5T760-480q0 17-11.5 28.5T720-440H520v200q0 17-11.5 28.5T480-200q-17 0-28.5-11.5T440-240v-200Z" />
    </svg>
  </button>

  <div id="modal">
    <div id="modal_content">
      <div id="modal_header">
        <h3>Modal Title</h3>
        <span class="close_btn" onclick="hideModal()">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="undefined">
            <path
              d="M480-424 284-228q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536-480l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480-424Z" />
          </svg>
        </span>
      </div>
      <div id="modal_body">
        <input type="text" placeholder="Project Name" />
        <input type="text" placeholder="Project Description" />
        <!-- <input type="date" placeholder="Project Deadline" />
          <select name="priority" id="priority" placeholder="Priority">
            <option value="LOW">Low</option>
            <option value="MEDIUM">Medium</option>
            <option value="HIGH">High</option>
          </select>
          <select name="status" id="status" placeholder="Status">
            <option value="PENDING">Pending</option>
            <option value="INPROGRESS">In Progress</option>
            <option value="COMPLETED">Completed</option>
          </select> -->
      </div>
      <div id="modal_footer">
        <button onclick="hideModal()" class="discard_btn">Discard</button>
        <button class="create_btn">Create</button>
      </div>
    </div>
  </div>

  <script>
    // Get modal elements
    const modalContent = document.getElementById("modal_content");
    const projectNameInput = document.querySelector(
      '#modal_body input[placeholder="Project Name"]'
    );
    const projectDescInput = document.querySelector(
      '#modal_body input[placeholder="Project Description"]'
    );
    const projectDeadlineInput = document.querySelector(
      '#modal_body input[type="date"]'
    );
    const prioritySelect = document.getElementById("priority");
    const statusSelect = document.getElementById("status");
    const createBtn = document.querySelector(".create_btn");
    const wrapper = document.querySelector(".wrapper");
    const floatBtn = document.querySelector(".float-btn");
    const modal = document.getElementById("modal");

    floatBtn.addEventListener("click", () => {
      modal.style.display = "flex";
    });

    function hideModal() {
      modal.style.display = "none";
    }
    // Close modal when clicking outside content
    modal.addEventListener("click", (e) => {
      if (e.target === modal) {
        hideModal();
      }
    });

    // Handle create button click
    createBtn.addEventListener("click", () => {
      // Get form values
      const projectData = {
        name: projectNameInput.value,
        description: projectDescInput.value,
        deadline: projectDeadlineInput.value,
        priority: prioritySelect.value,
        status: statusSelect.value,
      };

      // Validate required fields
      if (
        !projectData.name ||
        !projectData.description ||
        !projectData.deadline
      ) {
        alert("Please fill in all required fields");
        return;
      }

      // Create new task card
      const taskCard = document.createElement("div");
      taskCard.className = "task-card";
      taskCard.innerHTML = `
          <div class="card-header">
            <div>
              <span class="priority-badge">${projectData.priority}</span>
              <h3 class="task-title">${projectData.name}</h3>
              <p class="task-description">${projectData.description}</p>
            </div>
            <button class="menu-button">
              <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                <circle cx="5" cy="12" r="2" />
                <circle cx="12" cy="12" r="2" />
                <circle cx="19" cy="12" r="2" />
              </svg>
            </button>
          </div>
          <div class="card-footer">
            <div class="avatar-group">
              <img src="https://via.placeholder.com/32" class="avatar" alt="User 1" />
              <img src="https://via.placeholder.com/32" class="avatar" alt="User 2" />
            </div>
            <div class="stats">
              <div class="stat">
                <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2" stroke-width="2"/>
                  <circle cx="9" cy="7" r="4" stroke-width="2" />
                  <path d="M23 21v-2a4 4 0 00-3-3.87" stroke-width="2" />
                  <path d="M16 3.13a4 4 0 010 7.75" stroke-width="2" />
                </svg>
                <span>8</span>
              </div>
              <div class="stat">
                <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M8 12h8M8 16h4" stroke-width="2" stroke-linecap="round"/>
                  <path d="M16 4H8a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V6a2 2 0 00-2-2z" stroke-width="2"/>
                </svg>
                <span>16</span>
              </div>
            </div>
          </div>
        `;

      // Add new task card to wrapper
      wrapper.appendChild(taskCard);

      // Clear form
      projectNameInput.value = "";
      projectDescInput.value = "";
      projectDeadlineInput.value = "";
      prioritySelect.selectedIndex = 0;
      statusSelect.selectedIndex = 0;

      // Hide modal
      hideModal();
    });

    // Prevent modal content clicks from bubbling to modal
    modalContent.addEventListener("click", (e) => {
      e.stopPropagation();
    });
  </script>

  <!-- Custom JS -->
  <script></script>
  <script src="js/main.js" type="module"></script>
  <script src="js/header.js"></script>
  <script src="js/dynamicValues.js"></script>
</body>

</html>